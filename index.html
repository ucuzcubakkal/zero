<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Zero – Eco Lifestyle Coach</title>
  <meta name="description" content="Zero helps you track your carbon footprint, get personalized eco tips, and monitor progress — in any language, anywhere.">
  <style>
    :root{ --bg:#0b1e18; --card:#123126; --muted:#b6d5ca; --accent:#7be495; --text:#ffffff; }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;background:var(--bg);color:var(--text)}
    .wrap{max-width:940px;margin:0 auto;padding:20px}
    header{display:flex;gap:12px;align-items:center;justify-content:space-between}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:40px;height:40px;border-radius:12px;background:linear-gradient(135deg,#2fbf71,#0ea371)}
    .lang{display:flex;gap:8px}
    button, a.btn{border:0;border-radius:10px;padding:10px 14px;cursor:pointer;background:var(--accent);color:#0b1e18;font-weight:600;text-decoration:none}
    button.ghost{background:transparent;color:var(--muted);border:1px solid #26453b}
    .card{background:color-mix(in srgb, var(--card) 90%, transparent);border:1px solid #1f3c31;border-radius:16px;padding:20px;margin-top:16px}
    h1{margin:14px 0 6px}
    p.lead{margin:0;color:var(--muted)}
    .grid{display:grid;gap:14px}
    @media(min-width:900px){ .grid{grid-template-columns:1.1fr .9fr} }
    ul{margin:0;padding-left:18px}
    .muted{color:var(--muted)}
    footer{margin:30px 0 10px;color:var(--muted);font-size:14px;display:flex;gap:12px;flex-wrap:wrap}
    .chips{display:flex;gap:8px;flex-wrap:wrap}
    .chip{border:1px solid #2b5144;color:var(--muted);padding:6px 10px;border-radius:999px;font-size:13px}
    .badge{display:inline-block;background:#0f342a;border:1px solid #2a5c4b;border-radius:8px;padding:6px 10px;font-size:13px;color:var(--muted)}
    .tip{border-left:3px solid var(--accent);padding-left:10px}
    .links{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .kpi{display:flex;gap:14px;flex-wrap:wrap}
    .kpi .box{flex:1 1 180px;border:1px solid #1f3c31;background:#0d261f;border-radius:12px;padding:12px}
    .center{display:flex;align-items:center;gap:10px}
    .err{background:#3a1414;border:1px solid #6a2a2a;color:#f5d0d0;padding:10px;border-radius:8px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo"></div>
        <div>
          <div style="font-weight:700">Zero – Eco Lifestyle Coach</div>
          <div class="muted" id="subtitle">Track Your Eco Impact</div>
        </div>
      </div>
      <div class="lang">
        <button class="ghost" onclick="setLang('en')">English</button>
        <button class="ghost" onclick="setLang('tr')">Türkçe</button>
      </div>
    </header>

    <div class="grid">
      <section class="card">
        <h1 id="welcome">Welcome to Zero</h1>
        <p class="lead" id="desc">Calculate your carbon footprint, get personalized eco tips, and track your progress — in any language, anywhere.</p>

        <div class="kpi" style="margin-top:12px">
          <div class="box">
            <div class="muted" id="kpi1t">Current Impact</div>
            <div style="font-size:22px;font-weight:700">—</div>
            <div class="muted" id="kpi1d">Starter mode (no payments)</div>
          </div>
          <div class="box">
            <div class="muted" id="kpi2t">This Month</div>
            <div style="font-size:22px;font-weight:700">—</div>
            <div class="muted" id="kpi2d">Track tips completed</div>
          </div>
          <div class="box">
            <div class="muted" id="kpi3t">Badges</div>
            <div class="chips"><span class="chip">Starter</span><span class="chip">Ad-Free Tips</span></div>
          </div>
        </div>

        <div class="links">
          <a class="btn" href="/health.html" id="healthBtn">Health Check</a>
          <a class="btn" href="#tips" id="tipsBtn">Eco Tips</a>
          <a class="btn" href="#reports" id="reportsBtn">Monthly Report</a>
        </div>
      </section>

      <aside class="card" id="tips">
        <div class="center" style="justify-content:space-between">
          <h3 id="tipsTitle" style="margin:0">Quick Eco Tips</h3>
          <span class="badge" id="savedBadge">Saved: 0</span>
        </div>
        <div id="tipsList" style="margin-top:10px;display:grid;gap:10px"></div>
        <div id="tipsErr" style="margin-top:10px;display:none" class="err"></div>
      </aside>
    </div>

    <section class="card" id="reports" style="margin-top:16px">
      <h3 id="reportTitle" style="margin:0 0 6px">Monthly Progress</h3>
      <p class="muted" id="reportDesc">Save tips as you complete them; your monthly progress will appear here.</p>
      <div class="chips" id="monthChips">
        <span class="chip">Tips completed: <b id="doneCount">0</b></span>
        <span class="chip">Languages: EN / TR</span>
        <span class="chip">Payments: Disabled</span>
      </div>
    </section>

    <footer>
      <a class="ghost" href="/privacy.html">Privacy</a>
      <a class="ghost" href="/terms.html">Terms</a>
      <span>© <span id="year"></span> Zero</span>
    </footer>
  </div>

  <script>
    // Dil metinleri
    const texts = {
      en: {
        subtitle:"Track Your Eco Impact",
        welcome:"Welcome to Zero – Eco Lifestyle Coach",
        desc:"Calculate your carbon footprint, get personalized eco tips, and track your progress — in any language, anywhere.",
        kpi1t:"Current Impact", kpi1d:"Starter mode (no payments)",
        kpi2t:"This Month", kpi2d:"Track tips completed",
        tipsTitle:"Quick Eco Tips", saved:"Saved",
        health:"Health Check", tips:"Eco Tips", reportBtn:"Monthly Report",
        reportTitle:"Monthly Progress", reportDesc:"Save tips as you complete them; your monthly progress will appear here.",
        tipsErr:"Could not load tips.csv. You can still use the app."
      },
      tr: {
        subtitle:"Çevresel Etkini Takip Et",
        welcome:"Zero – Eko Yaşam Koçuna Hoş Geldiniz",
        desc:"Karbon ayak izinizi hesaplayın, size özel çevre dostu ipuçları alın ve ilerlemenizi her dilde, her yerde takip edin.",
        kpi1t:"Mevcut Etki", kpi1d:"Başlangıç modu (ödeme yok)",
        kpi2t:"Bu Ay", kpi2d:"Tamamlanan ipuçlarını takip edin",
        tipsTitle:"Hızlı Çevre İpuçları", saved:"Kaydedildi",
        health:"Sağlık Kontrolü", tips:"İpuçları", reportBtn:"Aylık Rapor",
        reportTitle:"Aylık İlerleme", reportDesc:"Uyguladığınız ipuçlarını kaydedin; aylık ilerlemeniz burada görünür.",
        tipsErr:"tips.csv yüklenemedi. Uygulamayı yine de kullanabilirsiniz."
      }
    };

    function setLang(lang){ localStorage.setItem('lang',lang); applyLang(lang); }
    function getLang(){ return localStorage.getItem('lang') || (navigator.language||'en').slice(0,2); }

    function applyLang(lang){
      const t = texts[lang] || texts.en;
      document.getElementById('subtitle').textContent = t.subtitle;
      document.getElementById('welcome').textContent = t.welcome;
      document.getElementById('desc').textContent = t.desc;
      document.getElementById('kpi1t').textContent = t.kpi1t;
      document.getElementById('kpi1d').textContent = t.kpi1d;
      document.getElementById('kpi2t').textContent = t.kpi2t;
      document.getElementById('kpi2d').textContent = t.kpi2d;
      document.getElementById('tipsTitle').textContent = t.tipsTitle;
      document.getElementById('healthBtn').textContent = t.health;
      document.getElementById('tipsBtn').textContent = t.tips;
      document.getElementById('reportsBtn').textContent = t.reportBtn;
      document.getElementById('reportTitle').textContent = t.reportTitle;
      document.getElementById('reportDesc').textContent = t.reportDesc;
      document.getElementById('tipsErr').textContent = t.tipsErr;
      loadTipsCSV(lang);
    }

    // Kullanıcının ilerleme sayacı
    function saveTip(){
      const k='zero_saved_count';
      const n=parseInt(localStorage.getItem(k)||'0',10)+1;
      localStorage.setItem(k,String(n));
      document.getElementById('savedBadge').textContent = (texts[getLang()]?.saved||'Saved')+': '+n;
      document.getElementById('doneCount').textContent = n;
    }

    // CSV'den ipuçlarını yükle (dosya: /tips.csv)
    async function loadTipsCSV(lang){
      const list = document.getElementById('tipsList');
      list.innerHTML = '';
      const err = document.getElementById('tipsErr');
      err.style.display='none';
      try{
        const res = await fetch('/tips.csv?cache=' + Date.now());
        if(!res.ok) throw new Error('HTTP '+res.status);
        const text = await res.text();
        const rows = text.split(/\r?\n/).map(r=>r.trim()).filter(Boolean);
        // Başlık: lang,tip
        const items = rows.slice(1).map(r=>{
          const idx = r.indexOf(',');
          if(idx<0) return null;
          const l = r.slice(0,idx).trim();
          const tip = r.slice(idx+1).trim();
          return { lang:l.toLowerCase(), tip };
        }).filter(Boolean).filter(it => it.lang=== (texts[lang]?lang:'en'));
        if(items.length===0){
          const fallback = [
            {tip: lang==='tr' ? 'Kısa mesafelerde yürüyün veya bisiklete binin.' : 'Walk or cycle for short trips.'},
            {tip: lang==='tr' ? 'Evde LED ampul kullanın.' : 'Use LED bulbs at home.'},
            {tip: lang==='tr' ? 'Çamaşırları soğuk suyla yıkayın.' : 'Wash clothes in cold water.'}
          ];
          renderTips(fallback, lang);
        }else{
          renderTips(items, lang);
        }
      }catch(e){
        err.style.display='block';
      }
      // rozet sayacı yenile
      const savedNow = parseInt(localStorage.getItem('zero_saved_count')||'0',10);
      document.getElementById('savedBadge').textContent = (texts[getLang()]?.saved||'Saved')+': '+savedNow;
      document.getElementById('doneCount').textContent = savedNow;
    }

    function renderTips(items, lang){
      const list = document.getElementById('tipsList');
      list.innerHTML='';
      items.forEach((it)=>{
        const row = document.createElement('div');
        row.className='tip';
        row.innerHTML = `<div>${it.tip}</div>
          <div class="links"><button class="ghost" onclick="saveTip()">✓ ${(texts[lang]?.saved)||'Saved'}</button></div>`;
        list.appendChild(row);
      });
    }

    // init
    const initLang = texts[getLang()] ? getLang() : 'en';
    applyLang(initLang);
    document.getElementById('year').textContent = new Date().getFullYear();
    const savedNow = parseInt(localStorage.getItem('zero_saved_count')||'0',10);
    document.getElementById('savedBadge').textContent = (texts[initLang].saved||'Saved')+': '+savedNow;
    document.getElementById('doneCount').textContent = savedNow;
  </script>
</body>
</html>
